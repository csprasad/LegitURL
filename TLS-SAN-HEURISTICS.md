# TLS SAN Heuristics

LegitURL uses several red-flag patterns to evaluate whether a TLS certificate was likely issued for scam, tracking, or disposable infrastructure.

## Red Flag: Oversized SAN List

A SAN list with 25 or more entries pointing to **unrelated domains** (e.g., `abc-tracker.net`, `cdn34-bid.com`, `news0.site`, etc.), especially **without wildcard entries** like `*.trusted.com`, is highly suspicious.

Short certificate lifespans (30 days or less) combined with this pattern suggest the cert is:

- Auto-generated by a tracking service
- Meant to quickly rotate infrastructure
- Possibly covering a scam or affiliate network

### SAN‑pattern analysis – spotting cloaked infrastructure

LegitURL examines the **Subject Alternative Name (SAN)** list for signals that a certificate is protecting more than just a normal “set of sub‑sites.”

**Red‑flag pattern**

> **Many (10 – 100) unrelated FQDNs**, no wildcard entries, and a certificate age < 30 days - especially when the issuer is Let’s Encrypt,  strongly suggests throw‑away scam infra.

| Why this pattern is rare on legitimate sites |
|----------------------------------------------|
| **Wildcards are cheaper to maintain** — orgs usually issue `*.example.com`. |
| **Let’s Encrypt wildcards require DNS‑01** — attackers prefer HTTP‑01 because they don’t own DNS. |
| **Dozens of disparate FQDNs** make no operational sense for normal businesses but are perfect for phishing kits, redirect chains, and disposable botnet mailers. |

A SAN list packed with unrelated domains is therefore scored as **“Cloaked Infra”**.  
When combined with weak headers, shady TLDs (`.biz`, `.click`), or obfuscated JavaScript, the overall risk escalates quickly.

#### Counter‑example: Steam

* `steampowered.com` → 48 SAN entries, Let’s Encrypt DV, no wildcard.  
* Immediate redirect to `store.steampowered.com` → EV cert, only 2 SANs.

Because the chain lands on a **stronger, scoped EV certificate**, LegitURL waives the penalty for the first hop, context overrules the raw SAN count.
